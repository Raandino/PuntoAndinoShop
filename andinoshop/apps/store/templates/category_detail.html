{% extends 'base.html' %}

{% block title %}{{ category.title }} | {% endblock %}
{% block content %}
<div class="pt-2 px-md-4 mb-3 bg-white border-bottom shadow-sm" id="search-query">
   
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb" style="background-color: white;">
            <li class="breadcrumb-item"><a href="{% url 'frontpage' %}" style="color: black;">Inicio</a></li>
            {% if category.parent %}
                <li class="breadcrumb-item" ><a href="{% url 'category_detail' category.parent.slug %}" style="color: black;">{{category.parent.title}}</a></li>
            {% endif %}
                <li class="breadcrumb-item active" >{{category.title}}</li>
        </ol>
 
    </nav>
</div>


<div class="container wow fadeIn">
    <div class="row">
        <div class="col-12 col-sm-3">
            <h4 class="d-flex justify-content-between align-items-center mb-3">Filtro</h4>

            <form action="" method="GET">
                <div class="form-group">
                    <label for="brand">Marca</label>
                    <select id="brand" class="form-control browser-default custom-select" name="brand" id="">
                       <option selected>Escoger...</option> 
                       {% for brand in q %}
                            <option value="{{ brand.brand }}">{{ brand.brand }}</option>
                       {% endfor %}
                    </select>
                </div>

                <div class="form-group">
                    <label for="pricemin">Precio minimo</label>
                    <input type="number" min=0 class="form-control" id="pricemin" name="price_min" placeholder="0">
                </div>
                <div class="form-group">
                    <label for="pricemax">Precio Maximo</label>
                    <input type="number" min=0 class="form-control" id="pricemax" name="price_max" placeholder="1000?">
                </div>
                
                <p>Ordenar por:</p>
                <div class="form-group">
                    <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="featured" name="featured">
                    <label class="custom-control-label" for="featured">Destacados</label>
                    </div>
                </div>

                <div class="form-group">
                    <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="discount" name="discount">
                    <label class="custom-control-label" for="discount">Descuento</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="review">Puntuacion</label>
                    <select id="review" class="form-control browser-default custom-select" name="review" id="">
                       <option selected>Estrellas</option> 
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>

                    </select>
                </div>
                <button class="btn btn-primary" type="submit">Filtrar</button>
                

            </form>


        </div>
        <div class="col">
            <div class="row">
                {% for product in products %}
                    <div class="col-lg-4 col-md-12 mb-4">
                        <div class="card card-ecommerce">
                            <div class="overlay">
                                <img src="{{ product.thumbnail.url}}" class="img-fluid mx-auto d-block" alt="">
                                <a>
                                    <div class="mask rgba-white slight">

                                    </div>
                                </a>
                            </div>

                            <div class="card-body">
                                <h6 class="card-title mb-1">
                                <strong><a href="{% url 'product_detail' product.category.slug product.slug %}" class="dark-grey-text">{{product.name}}</a></strong> 
                                </h6>

                                <p class="card-text">Puntuación: {% if product.get_rating == 0 %}No hay reviews{% else %} {{ product.get_rating|floatformat:1 }} {% endif %}</p>
                                
                                <hr>
                                <span class="float-left card-text">{% if product.disccount_price %}
                                    <del style="color: grey;">C${{ product.price }}</del>
                                    <strong> C${{ product.disccount_price }}</strong>
                                {% else %}
                                   <strong>C${{ product.price }}</strong>
                                {% endif %}</span>

                                <span class="float-right">
                                    <a class="material-tooltip-main" id="ver" data-toggle="tooltip" data-placement="top" title="Ver mas" href="{% url 'product_detail' product.category.slug product.slug %}">
                                        <i class="fas fa-eye ml-3"></i>
                                      </a>
                                      <a class="material-tooltip-main" id="cora" data-toggle="tooltip" data-placement="top" title="Añadir a Favoritos">
                                        <i class="fas fa-heart ml-3"></i>
                                      </a>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                {% endfor %}
                
            
            </div>
            <div class="text-center">
                <ul class="pagination pagination-circle pg-blue">
                    
                    <li class="page-item"><a href="?page=1" class="page-link">Inicio</a></li>
                    {% if products.has_previous %}

                        <li class="page-item"><a href="?page={{ products.previous_page_number }}" class="page-link">Anterior</a></li>
                    {% endif %}

                    {% for page in products.paginator %}
                    <li class="page-item" id="paginas"><a href="?page={{ page.number }}" class="page-link">{{ page.number }}</a></li>
                    {% endfor %}

                    {% if products.has_next %}
                    <li class="page-item"><a href="?page={{ products.next_page_number }}" class="page-link">Siguiente</a></li>
                    <li class="page-item"><a href="?page={{ products.paginator.num_pages }}" class="page-link">Ultimo</a></li>
                    {% endif %}

                </ul>
     
            </div>
        </div>
    </div>
</div>



    


{% endblock %}
